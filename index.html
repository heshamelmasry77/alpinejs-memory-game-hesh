<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Document</title>
  <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js" defer></script>
  <link href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css" rel="stylesheet">
</head>

<body>
<div x-data="game()" class="px-10 flex justify-center items-center min-h-screen">
  <div class="fixed top-0 right-0 p-10 font-bold text-3xl">
    <span x-text="points"></span>
    <span class="text-sm">pts</span>
  </div>
  <div class="grid grid-cols-4 gap-10 flex-1">
    <template x-for="card in cards">
      <div>
        <button
          x-show="!card.cleared"
          :style="'background: ' + (card.flipped ? card.color : '#999')"
          @click="flipCard(card)"
          class="w-full h-32 cursor-pointer"
        ></button>
      </div>
    </template>
  </div>
</div>
<script>

  function game() {
    return {
      // DATA
      cards: [
        {color: 'green',flipped: false,cleared: false},
        {color: 'red',flipped: false,cleared: false},
        {color: 'blue',flipped: false,cleared: false},
        {color: 'yellow',flipped: false,cleared: false},
        {color: 'green',flipped: false,cleared: false},
        {color: 'red',flipped: false,cleared: false},
        {color: 'blue',flipped: false,cleared: false},
        {color: 'yellow',flipped: false,cleared: false},
      ],

      // COMPUTED
      get flippedCards() {
        // this will return the flipped cards only flipped = true
        return this.cards.filter((card) => card.flipped)
      },
      get clearedCards() {
        // get cleared cards
        return this.cards.filter((card) => card.cleared)
      },
      get points() {
        return this.clearedCards.length
      },

      // METHODS
      flipCard(card) {
        console.log(card)
        card.flipped = !card.flipped
        if (this.flippedCards.length === 2) {
          // alert('time to check for match')
          if (this.flippedCards[0]['color'] === this.flippedCards[1]['color']) {
            alert('you have a matched cards')
            // Change the cleared status of the cards
            this.flippedCards.forEach(card => card.cleared = true)
          }
        }
      }
    }
  }
</script>
</body>
</html>
